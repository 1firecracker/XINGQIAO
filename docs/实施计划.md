# ğŸ“‹ æ˜Ÿæ¡¥ç³»ç»Ÿ - é»‘å®¢æ¾å®æ–½è®¡åˆ’

## ğŸ¯ æ¦‚è¿°

æœ¬æ–‡æ¡£ä¸ºé»‘å®¢æ¾è½»é‡çº§ç‰ˆæœ¬çš„è¯¦ç»†å®æ–½è®¡åˆ’ï¼ŒåŸºäºå•ä¸€FastAPIåç«¯ + Reactå‰ç«¯æ¶æ„ã€‚è®¡åˆ’æ€»æ—¶é•¿24å°æ—¶ï¼Œåˆ†é˜¶æ®µå®æ–½ï¼Œç¡®ä¿åœ¨æ¯”èµ›æ—¶é—´å†…å®Œæˆå¯æ¼”ç¤ºçš„å®Œæ•´åº”ç”¨ã€‚

### â° æ—¶é—´åˆ†é…

- **æ€»æ—¶é—´**: 24å°æ—¶
- **Phase 1**: åŸºç¡€æ­å»º (4å°æ—¶)
- **Phase 2**: æ ¸å¿ƒåŠŸèƒ½ (8å°æ—¶)
- **Phase 3**: é›†æˆæµ‹è¯• (4å°æ—¶)
- **Phase 4**: æ¼”ç¤ºä¼˜åŒ– (4å°æ—¶)
- **Phase 5**: éƒ¨ç½²æ¼”ç¤º (4å°æ—¶)

## ğŸ“ é¡¹ç›®ç»“æ„è§„åˆ’

### å®Œæ•´é¡¹ç›®ç»“æ„

```
xingqiao-hackathon/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py              # FastAPIåº”ç”¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ config.py            # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ database.py          # æ•°æ®åº“é…ç½®
â”‚   â”‚   â”œâ”€â”€ models.py            # SQLAlchemyæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ schemas.py           # Pydanticæ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ crud.py              # æ•°æ®åº“CRUDæ“ä½œ
â”‚   â”‚   â”œâ”€â”€ ai_service.py        # AIæœåŠ¡å°è£…
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ scenarios.py     # åœºæ™¯ç®¡ç†è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ training.py      # è®­ç»ƒç®¡ç†è·¯ç”±
â”‚   â”‚   â”‚   â””â”€â”€ ai.py            # AIæœåŠ¡è·¯ç”±
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â””â”€â”€ cache.py         # ç¼“å­˜å·¥å…·
â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ conftest.py          # æµ‹è¯•é…ç½®
â”‚   â”‚   â”œâ”€â”€ test_scenarios.py    # åœºæ™¯æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_training.py     # è®­ç»ƒæµ‹è¯•
â”‚   â”‚   â””â”€â”€ test_ai.py           # AIæœåŠ¡æµ‹è¯•
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ alembic/                 # æ•°æ®åº“è¿ç§» (å¯é€‰)
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â””â”€â”€ assets/              # é™æ€èµ„æº
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ client.js        # APIå®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ scenarios.js     # åœºæ™¯API
â”‚   â”‚   â”‚   â”œâ”€â”€ training.js      # è®­ç»ƒAPI
â”‚   â”‚   â”‚   â””â”€â”€ ai.js            # AI API
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ common/          # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Button.jsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Card.jsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Loading.jsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ErrorBoundary.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ScenarioCard.jsx  # åœºæ™¯å¡ç‰‡
â”‚   â”‚   â”‚   â”œâ”€â”€ TrainingSession.jsx # è®­ç»ƒä¼šè¯
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx     # æ•°æ®é¢æ¿
â”‚   â”‚   â”‚   â””â”€â”€ Settings.jsx      # è®¾ç½®é¢æ¿
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ useScenarios.js   # åœºæ™¯ç®¡ç†hook
â”‚   â”‚   â”‚   â”œâ”€â”€ useTraining.js    # è®­ç»ƒç®¡ç†hook
â”‚   â”‚   â”‚   â””â”€â”€ useAI.js          # AIæœåŠ¡hook
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Home.jsx          # é¦–é¡µ
â”‚   â”‚   â”‚   â”œâ”€â”€ Training.jsx      # è®­ç»ƒé¡µé¢
â”‚   â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx     # æ•°æ®é¡µé¢
â”‚   â”‚   â”‚   â””â”€â”€ Settings.jsx      # è®¾ç½®é¡µé¢
â”‚   â”‚   â”œâ”€â”€ context/
â”‚   â”‚   â”‚   â””â”€â”€ AppContext.jsx    # åº”ç”¨ä¸Šä¸‹æ–‡
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ constants.js      # å¸¸é‡
â”‚   â”‚   â”‚   â””â”€â”€ helpers.js        # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ App.jsx
â”‚   â”‚   â”œâ”€â”€ index.jsx
â”‚   â”‚   â””â”€â”€ types.js              # ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ nginx.conf                # Nginxé…ç½®
â”œâ”€â”€ docs/                        # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ é»‘å®¢æ¾è½»é‡çº§æ–¹æ¡ˆ.md
â”‚   â””â”€â”€ å®æ–½è®¡åˆ’.md
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env.example
â”œâ”€â”€ README.md
â””â”€â”€ .gitignore
```

## ğŸ”§ Phase 1: åŸºç¡€æ­å»º (4å°æ—¶)

### 1.1 åç«¯åŸºç¡€æ­å»º (2å°æ—¶)

#### 1.1.1 é¡¹ç›®ç»“æ„åˆå§‹åŒ–
```bash
# åˆ›å»ºé¡¹ç›®ç»“æ„
mkdir -p xingqiao-hackathon/backend/app/routes
mkdir -p xingqiao-hackathon/backend/app/utils
mkdir -p xingqiao-hackathon/backend/tests
mkdir -p xingqiao-hackathon/frontend/src/{api,components/{common},hooks,pages,context,utils}

# åˆå§‹åŒ–Pythoné¡¹ç›®
cd xingqiao-hackathon/backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install fastapi uvicorn sqlalchemy python-multipart google-genai pydantic httpx
pip freeze > requirements.txt
```

#### 1.1.2 FastAPIåº”ç”¨åŸºç¡€é…ç½®

**æ–‡ä»¶: `backend/app/main.py`**
```python
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from app.routes import scenarios, training, ai

app = FastAPI(
    title="æ˜Ÿæ¡¥AIè®­ç»ƒç³»ç»Ÿ",
    description="é»‘å®¢æ¾è½»é‡çº§ç‰ˆæœ¬",
    version="1.0.0"
)

# CORSé…ç½®
app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:3000", "http://127.0.0.1:3000"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# è·¯ç”±æ³¨å†Œ
app.include_router(scenarios.router, prefix="/api/scenarios", tags=["scenarios"])
app.include_router(training.router, prefix="/api/training", tags=["training"])
app.include_router(ai.router, prefix="/api/ai", tags=["ai"])

@app.get("/health")
async def health_check():
    return {"status": "healthy"}
```

**æ–‡ä»¶: `backend/app/config.py`**
```python
import os
from typing import List

class Settings:
    # AIæœåŠ¡é…ç½®
    gemini_api_key: str = os.getenv("GEMINI_API_KEY", "")

    # æ•°æ®åº“é…ç½®
    database_url: str = os.getenv("DATABASE_URL", "sqlite:///./app.db")

    # åº”ç”¨é…ç½®
    debug: bool = os.getenv("DEBUG", "True").lower() == "true"
    secret_key: str = os.getenv("SECRET_KEY", "hackathon-secret-key")

    # CORSé…ç½®
    allowed_origins: List[str] = os.getenv(
        "ALLOWED_ORIGINS",
        "http://localhost:3000,http://127.0.0.1:3000"
    ).split(",")

settings = Settings()
```

#### 1.1.3 æ•°æ®åº“é…ç½®

**æ–‡ä»¶: `backend/app/database.py`**
```python
from sqlalchemy import create_engine
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
from app.config import settings

# åˆ›å»ºæ•°æ®åº“å¼•æ“
engine = create_engine(
    settings.database_url,
    connect_args={"check_same_thread": False} if "sqlite" in settings.database_url else {}
)

# åˆ›å»ºSessionå·¥å‚
SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)

# å£°æ˜å¼åŸºç±»
Base = declarative_base()

# æ•°æ®åº“ä¾èµ–æ³¨å…¥
def get_db():
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()
```

### 1.2 å‰ç«¯åŸºç¡€æ­å»º (2å°æ—¶)

#### 1.2.1 Reacté¡¹ç›®åˆå§‹åŒ–
```bash
cd xingqiao-hackathon/frontend
npx create-react-app . --template typescript --yes
npm install axios @types/node tailwindcss postcss autoprefixer
npm install -D @types/react @types/react-dom

# å®‰è£…Tailwind CSS
npx tailwindcss init -p
```

#### 1.2.2 Tailwindé…ç½®

**æ–‡ä»¶: `frontend/tailwind.config.js`**
```javascript
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: ["./src/**/*.{js,jsx,ts,tsx}"],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#eff6ff',
          500: '#3b82f6',
          600: '#2563eb',
          700: '#1d4ed8',
        }
      }
    },
  },
  plugins: [],
}
```

#### 1.2.3 APIå®¢æˆ·ç«¯é…ç½®

**æ–‡ä»¶: `frontend/src/api/client.js`**
```javascript
const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000';

class ApiClient {
  constructor(baseURL = API_BASE_URL) {
    this.baseURL = baseURL;
  }

  async request(endpoint, options = {}) {
    const url = `${this.baseURL}${endpoint}`;
    const config = {
      headers: {
        'Content-Type': 'application/json',
        ...options.headers,
      },
      ...options,
    };

    try {
      const response = await fetch(url, config);

      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      return await response.json();
    } catch (error) {
      console.error('API request failed:', error);
      throw error;
    }
  }

  get(endpoint, options = {}) {
    return this.request(endpoint, { ...options, method: 'GET' });
  }

  post(endpoint, data, options = {}) {
    return this.request(endpoint, {
      ...options,
      method: 'POST',
      body: JSON.stringify(data),
    });
  }

  put(endpoint, data, options = {}) {
    return this.request(endpoint, {
      ...options,
      method: 'PUT',
      body: JSON.stringify(data),
    });
  }

  delete(endpoint, options = {}) {
    return this.request(endpoint, { ...options, method: 'DELETE' });
  }
}

export default new ApiClient();
```

## ğŸ”§ Phase 2: æ ¸å¿ƒåŠŸèƒ½å®ç° (8å°æ—¶)

### 2.1 æ•°æ®æ¨¡å‹è®¾è®¡ (1å°æ—¶)

#### 2.1.1 SQLAlchemyæ¨¡å‹

**æ–‡ä»¶: `backend/app/models.py`**
```python
from sqlalchemy import Column, Integer, String, Text, Boolean, DateTime, ForeignKey, func
from sqlalchemy.orm import relationship
from app.database import Base

class Scenario(Base):
    __tablename__ = "scenarios"

    id = Column(Integer, primary_key=True, index=True)
    name = Column(String, nullable=False)
    description = Column(Text)
    icon = Column(String, default="ğŸ¯")
    is_custom = Column(Boolean, default=False)
    creator_id = Column(Integer, nullable=True)  # å¯é€‰ç”¨æˆ·ID

    # å…³è”
    steps = relationship("TrainingStep", back_populates="scenario", cascade="all, delete-orphan")

    created_at = Column(DateTime, default=func.now())

class TrainingStep(Base):
    __tablename__ = "training_steps"

    id = Column(Integer, primary_key=True, index=True)
    scenario_id = Column(Integer, ForeignKey("scenarios.id"), nullable=False)
    step_order = Column(Integer, nullable=False)
    instruction = Column(Text, nullable=False)
    image_prompt = Column(Text)
    image_url = Column(String)

    # å…³è”
    scenario = relationship("Scenario", back_populates="steps")

class TrainingRecord(Base):
    __tablename__ = "training_records"

    id = Column(Integer, primary_key=True, index=True)
    scenario_id = Column(Integer, ForeignKey("scenarios.id"), nullable=False)
    user_id = Column(Integer, nullable=True)  # å¯é€‰ç”¨æˆ·ID

    started_at = Column(DateTime, default=func.now())
    completed_at = Column(DateTime, nullable=True)
    score = Column(Integer, default=0)
    total_steps = Column(Integer, default=0)
    completed_steps = Column(Integer, default=0)

    # å…³è”
    scenario = relationship("Scenario")

class GeneratedContent(Base):
    __tablename__ = "generated_content"

    id = Column(Integer, primary_key=True, index=True)
    content_type = Column(String, nullable=False)  # 'image' or 'audio'
    prompt = Column(Text, nullable=False)
    content_url = Column(String)
    content_data = Column(Text)  # Base64 data for small content

    created_at = Column(DateTime, default=func.now())
```

#### 2.1.2 Pydanticæ¨¡å¼

**æ–‡ä»¶: `backend/app/schemas.py`**
```python
from pydantic import BaseModel
from typing import List, Optional
from datetime import datetime

# è®­ç»ƒæ­¥éª¤
class TrainingStepBase(BaseModel):
    step_order: int
    instruction: str
    image_prompt: Optional[str] = None
    image_url: Optional[str] = None

class TrainingStepCreate(TrainingStepBase):
    pass

class TrainingStep(TrainingStepBase):
    id: int
    scenario_id: int

    class Config:
        from_attributes = True

# åœºæ™¯
class ScenarioBase(BaseModel):
    name: str
    description: Optional[str] = None
    icon: str = "ğŸ¯"

class ScenarioCreate(ScenarioBase):
    steps: List[TrainingStepCreate] = []

class Scenario(ScenarioBase):
    id: int
    is_custom: bool
    creator_id: Optional[int]
    steps: List[TrainingStep] = []
    created_at: datetime

    class Config:
        from_attributes = True

# è®­ç»ƒè®°å½•
class TrainingRecordBase(BaseModel):
    scenario_id: int
    score: int = 0
    total_steps: int = 0
    completed_steps: int = 0

class TrainingRecordCreate(TrainingRecordBase):
    pass

class TrainingRecord(TrainingRecordBase):
    id: int
    started_at: datetime
    completed_at: Optional[datetime] = None

    class Config:
        from_attributes = True

# AIè¯·æ±‚/å“åº”
class ScenarioPlanRequest(BaseModel):
    topic: str
    preferences: Optional[dict] = {}

class ImageGenerateRequest(BaseModel):
    prompt: str

class APIResponse(BaseModel):
    success: bool
    data: Optional[dict] = None
    message: Optional[str] = None
    error: Optional[dict] = None
```

### 2.2 åç«¯APIå®ç° (4å°æ—¶)

#### 2.2.1 åœºæ™¯ç®¡ç†API

**æ–‡ä»¶: `backend/app/routes/scenarios.py`**
```python
from fastapi import APIRouter, Depends, HTTPException
from sqlalchemy.orm import Session
from typing import List
from app.database import get_db
from app.models import Scenario
from app.schemas import Scenario as ScenarioSchema, ScenarioCreate
from app.crud import create_scenario, get_scenarios, get_scenario

router = APIRouter()

@router.get("/", response_model=List[ScenarioSchema])
async def read_scenarios(skip: int = 0, limit: int = 100, db: Session = Depends(get_db)):
    scenarios = get_scenarios(db, skip=skip, limit=limit)
    return scenarios

@router.post("/", response_model=ScenarioSchema)
async def create_new_scenario(scenario: ScenarioCreate, db: Session = Depends(get_db)):
    return create_scenario(db=db, scenario=scenario)

@router.get("/{scenario_id}", response_model=ScenarioSchema)
async def read_scenario(scenario_id: int, db: Session = Depends(get_db)):
    db_scenario = get_scenario(db, scenario_id=scenario_id)
    if db_scenario is None:
        raise HTTPException(status_code=404, detail="Scenario not found")
    return db_scenario
```

#### 2.2.2 AIæœåŠ¡å®ç°

**æ–‡ä»¶: `backend/app/ai_service.py`**
```python
import google.generativeai as genai
from app.config import settings
from app.schemas import TrainingStepCreate
from typing import List

# é…ç½®Gemini AI
genai.configure(api_key=settings.gemini_api_key)

class AIService:
    def __init__(self):
        self.model = genai.GenerativeModel('gemini-1.5-flash')

    async def plan_scenario_steps(self, topic: str, preferences: dict = None) -> List[TrainingStepCreate]:
        """AIè§„åˆ’åœºæ™¯æ­¥éª¤"""
        prompt = f"""
        ä½ æ˜¯ä¸€ä½èµ„æ·±çš„ç‰¹æ®Šæ•™è‚²ä¸“å®¶ï¼Œä¸ºå­¤ç‹¬ç—‡å„¿ç«¥è®¾è®¡ç¤¾äº¤æ•…äº‹ã€‚

        ä¸»é¢˜ï¼š{topic}
        å„¿ç«¥åå¥½ï¼š{preferences or {}}

        è¯·è®¾è®¡3-5ä¸ªå¾ªåºæ¸è¿›çš„è®­ç»ƒæ­¥éª¤ï¼Œæ¯ä¸ªæ­¥éª¤åŒ…å«ï¼š
        1. æ¸…æ™°ç®€æ´çš„æŒ‡ä»¤
        2. å¯¹åº”çš„è§†è§‰æç¤ºè¯ï¼ˆè‹±æ–‡ï¼‰

        æ ¼å¼ï¼šè¿”å›JSONæ•°ç»„ï¼Œæ¯ä¸ªæ­¥éª¤åŒ…å«step_order, instruction, image_prompt
        """

        try:
            response = self.model.generate_content(prompt)
            # è§£æAIå“åº”å¹¶è½¬æ¢ä¸ºTrainingStepCreateå¯¹è±¡
            # è¿™é‡Œéœ€è¦æ ¹æ®å®é™…å“åº”æ ¼å¼è¿›è¡Œè§£æ
            steps_data = []  # è§£æåçš„æ•°æ®
            return [TrainingStepCreate(**step) for step in steps_data]
        except Exception as e:
            print(f"AI planning failed: {e}")
            # è¿”å›é»˜è®¤æ­¥éª¤
            return [
                TrainingStepCreate(
                    step_order=1,
                    instruction=f"å‡†å¤‡å¼€å§‹{topic}è®­ç»ƒ",
                    image_prompt=f"A child preparing for {topic} activity"
                ),
                TrainingStepCreate(
                    step_order=2,
                    instruction=f"æ‰§è¡Œ{topic}çš„ä¸»è¦æ­¥éª¤",
                    image_prompt=f"A child performing {topic} activity"
                ),
                TrainingStepCreate(
                    step_order=3,
                    instruction=f"å®Œæˆ{topic}è®­ç»ƒ",
                    image_prompt=f"A child completing {topic} activity"
                )
            ]

    async def generate_image(self, prompt: str) -> str:
        """ç”Ÿæˆè®­ç»ƒå›¾åƒ"""
        try:
            # ä½¿ç”¨Geminiçš„å›¾åƒç”Ÿæˆèƒ½åŠ›
            image_model = genai.GenerativeModel('gemini-pro-vision')
            response = image_model.generate_content([
                f"Create a simple, clear illustration for: {prompt}",
                "Style: minimalist, high contrast, educational"
            ])

            # è¿”å›base64ç¼–ç çš„å›¾åƒæ•°æ®
            if response.candidates and response.candidates[0].content.parts:
                return f"data:image/png;base64,{response.candidates[0].content.parts[0].inline_data.data}"
            else:
                return self._get_fallback_image(prompt)
        except Exception as e:
            print(f"Image generation failed: {e}")
            return self._get_fallback_image(prompt)

    def _get_fallback_image(self, prompt: str) -> str:
        """å¤‡ç”¨å›¾åƒç”Ÿæˆ"""
        # ä½¿ç”¨placeholderæœåŠ¡
        import urllib.parse
        encoded_prompt = urllib.parse.quote(prompt[:50])
        return f"https://placehold.co/400x400/3b82f6/ffffff?text={encoded_prompt}"

ai_service = AIService()
```

#### 2.2.3 AIè·¯ç”±

**æ–‡ä»¶: `backend/app/routes/ai.py`**
```python
from fastapi import APIRouter, HTTPException
from app.ai_service import ai_service
from app.schemas import ScenarioPlanRequest, ImageGenerateRequest, APIResponse

router = APIRouter()

@router.post("/plan-scenario", response_model=APIResponse)
async def plan_scenario(request: ScenarioPlanRequest):
    try:
        steps = await ai_service.plan_scenario_steps(
            request.topic,
            request.preferences
        )
        return APIResponse(
            success=True,
            data={"steps": [step.dict() for step in steps]},
            message="åœºæ™¯è§„åˆ’æˆåŠŸ"
        )
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"åœºæ™¯è§„åˆ’å¤±è´¥: {str(e)}")

@router.post("/generate-image", response_model=APIResponse)
async def generate_image(request: ImageGenerateRequest):
    try:
        image_url = await ai_service.generate_image(request.prompt)
        return APIResponse(
            success=True,
            data={"image_url": image_url},
            message="å›¾åƒç”ŸæˆæˆåŠŸ"
        )
    except Exception as e:
        raise HTTPException(status_code=500, detail=f"å›¾åƒç”Ÿæˆå¤±è´¥: {str(e)}")
```

### 2.3 å‰ç«¯æ ¸å¿ƒç»„ä»¶ (3å°æ—¶)

#### 2.3.1 åœºæ™¯å¡ç‰‡ç»„ä»¶

**æ–‡ä»¶: `frontend/src/components/ScenarioCard.jsx`**
```jsx
import React from 'react';

const ScenarioCard = ({ scenario, onStart }) => {
  const handleClick = () => {
    onStart(scenario);
  };

  return (
    <div
      className="bg-white rounded-xl shadow-sm border border-gray-200 p-4 hover:shadow-md transition-shadow cursor-pointer"
      onClick={handleClick}
    >
      <div className="flex items-center gap-3 mb-2">
        <span className="text-2xl">{scenario.icon}</span>
        <h3 className="font-semibold text-gray-800">{scenario.name}</h3>
      </div>
      <p className="text-sm text-gray-600">{scenario.description}</p>
      <div className="mt-3 flex items-center justify-between">
        <span className="text-xs text-gray-500">
          {scenario.steps?.length || 0} ä¸ªæ­¥éª¤
        </span>
        <button className="bg-blue-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-blue-600 transition-colors">
          å¼€å§‹è®­ç»ƒ
        </button>
      </div>
    </div>
  );
};

export default ScenarioCard;
```

#### 2.3.2 è®­ç»ƒä¼šè¯ç»„ä»¶

**æ–‡ä»¶: `frontend/src/components/TrainingSession.jsx`**
```jsx
import React, { useState, useEffect } from 'react';
import { useTraining } from '../hooks/useTraining';

const TrainingSession = ({ scenario, onFinish, onCancel }) => {
  const [currentStepIndex, setCurrentStepIndex] = useState(0);
  const [completedSteps, setCompletedSteps] = useState(0);
  const { completeStep, loading } = useTraining();

  const currentStep = scenario.steps[currentStepIndex];
  const progress = ((currentStepIndex + 1) / scenario.steps.length) * 100;

  const handleStepComplete = async () => {
    try {
      await completeStep(currentStep.id);
      setCompletedSteps(prev => prev + 1);

      if (currentStepIndex < scenario.steps.length - 1) {
        setCurrentStepIndex(prev => prev + 1);
      } else {
        // è®­ç»ƒå®Œæˆ
        const score = Math.round((completedSteps + 1) / scenario.steps.length * 100);
        onFinish(completedSteps + 1, scenario.steps.length);
      }
    } catch (error) {
      console.error('å®Œæˆæ­¥éª¤å¤±è´¥:', error);
    }
  };

  if (!currentStep) return null;

  return (
    <div className="max-w-md mx-auto bg-white rounded-2xl shadow-lg p-6">
      {/* è¿›åº¦æ¡ */}
      <div className="mb-6">
        <div className="flex justify-between text-sm text-gray-600 mb-2">
          <span>æ­¥éª¤ {currentStepIndex + 1} / {scenario.steps.length}</span>
          <span>{Math.round(progress)}%</span>
        </div>
        <div className="w-full bg-gray-200 rounded-full h-2">
          <div
            className="bg-blue-500 h-2 rounded-full transition-all duration-300"
            style={{ width: `${progress}%` }}
          ></div>
        </div>
      </div>

      {/* æ­¥éª¤å†…å®¹ */}
      <div className="text-center">
        {currentStep.image_url && (
          <img
            src={currentStep.image_url}
            alt="è®­ç»ƒæ­¥éª¤"
            className="w-full h-48 object-cover rounded-lg mb-4"
          />
        )}

        <h2 className="text-xl font-bold text-gray-800 mb-4">
          {currentStep.instruction}
        </h2>

        <div className="flex gap-3">
          <button
            onClick={onCancel}
            className="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-medium"
          >
            å–æ¶ˆ
          </button>
          <button
            onClick={handleStepComplete}
            disabled={loading}
            className="flex-1 bg-blue-500 text-white py-3 rounded-lg font-medium hover:bg-blue-600 disabled:opacity-50"
          >
            {loading ? 'å¤„ç†ä¸­...' : 'å®Œæˆ'}
          </button>
        </div>
      </div>
    </div>
  );
};

export default TrainingSession;
```

## ğŸ§ª Phase 3: é›†æˆæµ‹è¯• (4å°æ—¶)

### 3.1 æµ‹è¯•ç­–ç•¥

#### 3.1.1 æµ‹è¯•ç±»å‹
- **å•å…ƒæµ‹è¯•**: æµ‹è¯•å•ä¸ªå‡½æ•°å’Œç»„ä»¶
- **é›†æˆæµ‹è¯•**: æµ‹è¯•APIç«¯ç‚¹å’Œæ•°æ®åº“æ“ä½œ
- **ç«¯åˆ°ç«¯æµ‹è¯•**: æµ‹è¯•å®Œæ•´ç”¨æˆ·æµç¨‹

#### 3.1.2 æµ‹è¯•å·¥å…·é€‰æ‹©
```python
# åç«¯æµ‹è¯•ä¾èµ–
pytest==7.4.0
pytest-asyncio==0.21.1
httpx==0.25.0
pytest-cov==4.1.0

# å‰ç«¯æµ‹è¯•ä¾èµ–
@testing-library/react==13.4.0
@testing-library/jest-dom==5.16.5
@testing-library/user-event==14.4.3
```

### 3.2 åç«¯æµ‹è¯•å®ç°

#### 3.2.1 æµ‹è¯•é…ç½®

**æ–‡ä»¶: `backend/tests/conftest.py`**
```python
import pytest
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from app.database import Base
from app.config import Settings

# æµ‹è¯•æ•°æ®åº“é…ç½®
TEST_DATABASE_URL = "sqlite:///./test.db"

@pytest.fixture(scope="session")
def test_engine():
    engine = create_engine(TEST_DATABASE_URL, connect_args={"check_same_thread": False})
    Base.metadata.create_all(bind=engine)
    yield engine
    Base.metadata.drop_all(bind=engine)

@pytest.fixture(scope="function")
def db_session(test_engine):
    connection = test_engine.connect()
    transaction = connection.begin()
    session = sessionmaker(bind=connection)()

    yield session

    session.close()
    transaction.rollback()
    connection.close()

@pytest.fixture
def client():
    from fastapi.testclient import TestClient
    from app.main import app

    with TestClient(app) as test_client:
        yield test_client
```

#### 3.2.2 APIæµ‹è¯•ç¤ºä¾‹

**æ–‡ä»¶: `backend/tests/test_scenarios.py`**
```python
import pytest
from app.crud import create_scenario
from app.schemas import ScenarioCreate, TrainingStepCreate

def test_create_scenario(client, db_session):
    """æµ‹è¯•åˆ›å»ºåœºæ™¯"""
    scenario_data = ScenarioCreate(
        name="æµ‹è¯•åœºæ™¯",
        description="ç”¨äºæµ‹è¯•çš„åœºæ™¯",
        steps=[
            TrainingStepCreate(
                step_order=1,
                instruction="æµ‹è¯•æ­¥éª¤1",
                image_prompt="test prompt"
            )
        ]
    )

    response = client.post("/api/scenarios/", json=scenario_data.dict())
    assert response.status_code == 200

    data = response.json()
    assert data["name"] == "æµ‹è¯•åœºæ™¯"
    assert len(data["steps"]) == 1

def test_get_scenarios(client):
    """æµ‹è¯•è·å–åœºæ™¯åˆ—è¡¨"""
    response = client.get("/api/scenarios/")
    assert response.status_code == 200

    data = response.json()
    assert isinstance(data, list)

def test_get_scenario_not_found(client):
    """æµ‹è¯•è·å–ä¸å­˜åœ¨çš„åœºæ™¯"""
    response = client.get("/api/scenarios/999")
    assert response.status_code == 404
```

#### 3.2.3 AIæœåŠ¡æµ‹è¯•

**æ–‡ä»¶: `backend/tests/test_ai.py`**
```python
import pytest
from unittest.mock import patch, MagicMock
from app.ai_service import AIService

@pytest.fixture
def ai_service():
    return AIService()

@patch('app.ai_service.genai.GenerativeModel')
async def test_plan_scenario_steps(mock_model, ai_service):
    """æµ‹è¯•AIåœºæ™¯è§„åˆ’"""
    # æ¨¡æ‹ŸAIå“åº”
    mock_response = MagicMock()
    mock_response.text = '''
    {
        "steps": [
            {
                "step_order": 1,
                "instruction": "æµ‹è¯•æ­¥éª¤",
                "image_prompt": "test prompt"
            }
        ]
    }
    '''
    mock_model.return_value.generate_content.return_value = mock_response

    steps = await ai_service.plan_scenario_steps("æµ‹è¯•ä¸»é¢˜")

    assert len(steps) == 1
    assert steps[0].instruction == "æµ‹è¯•æ­¥éª¤"

@patch('app.ai_service.genai.GenerativeModel')
async def test_generate_image_fallback(mock_model, ai_service):
    """æµ‹è¯•å›¾åƒç”Ÿæˆå¤±è´¥æ—¶çš„fallback"""
    mock_model.return_value.generate_content.side_effect = Exception("API Error")

    image_url = await ai_service.generate_image("test prompt")

    # åº”è¯¥è¿”å›placeholder URL
    assert "placehold.co" in image_url
```

### 3.3 å‰ç«¯æµ‹è¯•å®ç°

#### 3.3.1 ç»„ä»¶æµ‹è¯•

**æ–‡ä»¶: `frontend/src/components/ScenarioCard.test.jsx`**
```jsx
import React from 'react';
import { render, screen, fireEvent } from '@testing-library/react';
import ScenarioCard from './ScenarioCard';

const mockScenario = {
  id: 1,
  name: 'æµ‹è¯•åœºæ™¯',
  description: 'åœºæ™¯æè¿°',
  icon: 'ğŸ¯',
  steps: [
    { id: 1, instruction: 'æ­¥éª¤1' },
    { id: 2, instruction: 'æ­¥éª¤2' }
  ]
};

const mockOnStart = jest.fn();

describe('ScenarioCard', () => {
  beforeEach(() => {
    mockOnStart.mockClear();
  });

  test('renders scenario information', () => {
    render(<ScenarioCard scenario={mockScenario} onStart={mockOnStart} />);

    expect(screen.getByText('æµ‹è¯•åœºæ™¯')).toBeInTheDocument();
    expect(screen.getByText('åœºæ™¯æè¿°')).toBeInTheDocument();
    expect(screen.getByText('2 ä¸ªæ­¥éª¤')).toBeInTheDocument();
  });

  test('calls onStart when clicked', () => {
    render(<ScenarioCard scenario={mockScenario} onStart={mockOnStart} />);

    const card = screen.getByRole('button', { name: /å¼€å§‹è®­ç»ƒ/i });
    fireEvent.click(card);

    expect(mockOnStart).toHaveBeenCalledWith(mockScenario);
  });
});
```

#### 3.3.2 Hookæµ‹è¯•

**æ–‡ä»¶: `frontend/src/hooks/useTraining.test.js`**
```javascript
import { renderHook, act, waitFor } from '@testing-library/react';
import { useTraining } from './useTraining';

// Mock API client
jest.mock('../api/client');
import apiClient from '../api/client';

describe('useTraining', () => {
  beforeEach(() => {
    jest.clearAllMocks();
  });

  test('completeStep calls API and updates state', async () => {
    apiClient.post.mockResolvedValue({
      success: true,
      data: { completed: true }
    });

    const { result } = renderHook(() => useTraining());

    act(() => {
      result.current.completeStep(1);
    });

    expect(result.current.loading).toBe(true);

    await waitFor(() => {
      expect(result.current.loading).toBe(false);
    });

    expect(apiClient.post).toHaveBeenCalledWith('/api/training/step', {
      stepId: 1
    });
  });
});
```

### 3.4 é›†æˆæµ‹è¯•

#### 3.4.1 ç«¯åˆ°ç«¯æµ‹è¯•

**æ–‡ä»¶: `frontend/src/e2e/training-flow.test.js`**
```javascript
describe('Training Flow', () => {
  test('complete full training scenario', () => {
    // è®¿é—®é¦–é¡µ
    cy.visit('/');

    // é€‰æ‹©åœºæ™¯
    cy.contains('è¶…å¸‚æ’é˜Ÿ').click();

    // å¼€å§‹è®­ç»ƒ
    cy.contains('å¼€å§‹è®­ç»ƒ').click();

    // å®Œæˆæ‰€æœ‰æ­¥éª¤
    cy.contains('å®Œæˆ').click();
    cy.contains('å®Œæˆ').click();
    cy.contains('å®Œæˆ').click();

    // æ£€æŸ¥å®Œæˆé¡µé¢
    cy.contains('è®­ç»ƒå®Œæˆ').should('be.visible');
    cy.contains('åˆ†æ•°').should('be.visible');
  });
});
```

## ğŸ“ Phase 4: æ–‡ä»¶å­˜å‚¨è§„åˆ’ (4å°æ—¶)

### 4.1 å­˜å‚¨æ¶æ„è®¾è®¡

#### 4.1.1 å­˜å‚¨ç­–ç•¥
- **SQLite**: ç»“æ„åŒ–æ•°æ® (ç”¨æˆ·ã€åœºæ™¯ã€è®°å½•)
- **æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ**: ç”Ÿæˆçš„å›¾åƒå’ŒéŸ³é¢‘æ–‡ä»¶
- **Base64å†…åµŒ**: å°æ–‡ä»¶ç›´æ¥å­˜å‚¨åœ¨æ•°æ®åº“ä¸­

#### 4.1.2 ç›®å½•ç»“æ„
```
xingqiao-hackathon/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app.db                    # SQLiteæ•°æ®åº“
â”‚   â”œâ”€â”€ uploads/                  # ä¸Šä¼ æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ images/               # ç”Ÿæˆçš„å›¾åƒ
â”‚   â”‚   â”‚   â”œâ”€â”€ scenarios/        # åœºæ™¯ç›¸å…³å›¾åƒ
â”‚   â”‚   â”‚   â””â”€â”€ training/         # è®­ç»ƒè¿‡ç¨‹å›¾åƒ
â”‚   â”‚   â””â”€â”€ audio/                # ç”Ÿæˆçš„éŸ³é¢‘
â”‚   â”‚       â””â”€â”€ voice/            # è¯­éŸ³æ–‡ä»¶
â”‚   â””â”€â”€ logs/                     # åº”ç”¨æ—¥å¿—
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”œâ”€â”€ static/               # é™æ€èµ„æº
â”‚   â”‚   â”‚   â”œâ”€â”€ images/           # å‰ç«¯é™æ€å›¾ç‰‡
â”‚   â”‚   â”‚   â””â”€â”€ icons/            # å›¾æ ‡æ–‡ä»¶
â”‚   â””â”€â”€ build/                    # æ„å»ºè¾“å‡º
```

### 4.2 æ–‡ä»¶ç®¡ç†å®ç°

#### 4.2.1 æ–‡ä»¶ä¸Šä¼ æœåŠ¡

**æ–‡ä»¶: `backend/app/utils/file_manager.py`**
```python
import os
import uuid
import base64
from pathlib import Path
from typing import Optional
from PIL import Image

class FileManager:
    def __init__(self, upload_dir: str = "uploads"):
        self.upload_dir = Path(upload_dir)
        self.upload_dir.mkdir(exist_ok=True)

        # åˆ›å»ºå­ç›®å½•
        self.images_dir = self.upload_dir / "images"
        self.audio_dir = self.upload_dir / "audio"
        self.images_dir.mkdir(exist_ok=True)
        self.audio_dir.mkdir(exist_ok=True)

    def save_image_from_base64(self, base64_data: str, filename: Optional[str] = None) -> str:
        """ä¿å­˜base64å›¾åƒæ•°æ®"""
        if not filename:
            filename = f"{uuid.uuid4()}.png"

        filepath = self.images_dir / filename

        # ç§»é™¤base64å‰ç¼€
        if ',' in base64_data:
            base64_data = base64_data.split(',')[1]

        # è§£ç å¹¶ä¿å­˜
        image_data = base64.b64decode(base64_data)
        with open(filepath, 'wb') as f:
            f.write(image_data)

        return str(filepath)

    def save_audio_from_base64(self, base64_data: str, filename: Optional[str] = None) -> str:
        """ä¿å­˜base64éŸ³é¢‘æ•°æ®"""
        if not filename:
            filename = f"{uuid.uuid4()}.mp3"

        filepath = self.audio_dir / filename

        # ç§»é™¤base64å‰ç¼€
        if ',' in base64_data:
            base64_data = base64_data.split(',')[1]

        # è§£ç å¹¶ä¿å­˜
        audio_data = base64.b64decode(base64_data)
        with open(filepath, 'wb') as f:
            f.write(audio_data)

        return str(filepath)

    def get_file_url(self, filepath: str) -> str:
        """è·å–æ–‡ä»¶è®¿é—®URL"""
        # åœ¨å¼€å‘ç¯å¢ƒä¸­è¿”å›æœ¬åœ°æ–‡ä»¶URL
        return f"/files/{filepath}"

    def cleanup_old_files(self, days: int = 7):
        """æ¸…ç†æ—§æ–‡ä»¶"""
        import time
        current_time = time.time()

        for file_path in self.upload_dir.rglob("*"):
            if file_path.is_file():
                if current_time - file_path.stat().st_mtime > days * 24 * 3600:
                    file_path.unlink()

file_manager = FileManager()
```

#### 4.2.2 é™æ€æ–‡ä»¶æœåŠ¡

**æ–‡ä»¶: `backend/app/main.py` (æ·»åŠ é™æ€æ–‡ä»¶æœåŠ¡)**
```python
from fastapi.staticfiles import StaticFiles
from app.utils.file_manager import file_manager

# æŒ‚è½½é™æ€æ–‡ä»¶ç›®å½•
app.mount("/files", StaticFiles(directory=file_manager.upload_dir), name="files")
```

### 4.3 ç¼“å­˜ç­–ç•¥

#### 4.3.1 å†…å®¹ç¼“å­˜

**æ–‡ä»¶: `backend/app/utils/cache.py`**
```python
import json
from typing import Optional, Dict, Any
from pathlib import Path

class ContentCache:
    def __init__(self, cache_dir: str = "cache"):
        self.cache_dir = Path(cache_dir)
        self.cache_dir.mkdir(exist_ok=True)

    def _get_cache_key(self, content_type: str, prompt: str) -> str:
        """ç”Ÿæˆç¼“å­˜é”®"""
        import hashlib
        key = f"{content_type}:{prompt}"
        return hashlib.md5(key.encode()).hexdigest()

    def get(self, content_type: str, prompt: str) -> Optional[Dict[str, Any]]:
        """è·å–ç¼“å­˜å†…å®¹"""
        cache_key = self._get_cache_key(content_type, prompt)
        cache_file = self.cache_dir / f"{cache_key}.json"

        if cache_file.exists():
            try:
                with open(cache_file, 'r', encoding='utf-8') as f:
                    return json.load(f)
            except:
                return None

        return None

    def set(self, content_type: str, prompt: str, data: Dict[str, Any]):
        """è®¾ç½®ç¼“å­˜å†…å®¹"""
        cache_key = self._get_cache_key(content_type, prompt)
        cache_file = self.cache_dir / f"{cache_key}.json"

        try:
            with open(cache_file, 'w', encoding='utf-8') as f:
                json.dump(data, f, ensure_ascii=False, indent=2)
        except Exception as e:
            print(f"Cache write failed: {e}")

    def clear_expired(self, max_age_hours: int = 24):
        """æ¸…ç†è¿‡æœŸç¼“å­˜"""
        import time
        current_time = time.time()
        max_age = max_age_hours * 3600

        for cache_file in self.cache_dir.glob("*.json"):
            if current_time - cache_file.stat().st_mtime > max_age:
                cache_file.unlink()

content_cache = ContentCache()
```

## ğŸš€ Phase 5: éƒ¨ç½²æ¼”ç¤º (4å°æ—¶)

### 5.1 Dockeré…ç½®

#### 5.1.1 åç«¯Dockerfile

**æ–‡ä»¶: `backend/Dockerfile`**
```dockerfile
FROM python:3.11-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    gcc \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# åˆ›å»ºérootç”¨æˆ·
RUN useradd --create-home --shell /bin/bash app \
    && chown -R app:app /app
USER app

# æš´éœ²ç«¯å£
EXPOSE 8000

# å¯åŠ¨å‘½ä»¤
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

#### 5.1.2 å‰ç«¯Dockerfile

**æ–‡ä»¶: `frontend/Dockerfile`**
```dockerfile
FROM node:18-alpine AS build

WORKDIR /app

# å¤åˆ¶packageæ–‡ä»¶
COPY package*.json ./
RUN npm ci

# å¤åˆ¶æºä»£ç 
COPY . .

# æ„å»ºåº”ç”¨
RUN npm run build

# ç”Ÿäº§é•œåƒ
FROM nginx:alpine

# å¤åˆ¶æ„å»ºäº§ç‰©
COPY --from=build /app/build /usr/share/nginx/html

# å¤åˆ¶nginxé…ç½®
COPY nginx.conf /etc/nginx/nginx.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

#### 5.1.3 Nginxé…ç½®

**æ–‡ä»¶: `frontend/nginx.conf`**
```nginx
events {
    worker_connections 1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    server {
        listen 80;
        server_name localhost;

        location / {
            root /usr/share/nginx/html;
            index index.html index.htm;
            try_files $uri $uri/ /index.html;
        }

        location /api {
            proxy_pass http://backend:8000;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        # ç¼“å­˜é™æ€èµ„æº
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
    }
}
```

### 5.2 æ¼”ç¤ºå‡†å¤‡

#### 5.2.1 æ¼”ç¤ºæ•°æ®å‡†å¤‡

**æ–‡ä»¶: `backend/app/initial_data.py`**
```python
from app.database import SessionLocal
from app.models import Scenario, TrainingStep

def create_initial_data():
    """åˆ›å»ºåˆå§‹æ¼”ç¤ºæ•°æ®"""
    db = SessionLocal()

    try:
        # æ£€æŸ¥æ˜¯å¦å·²æœ‰æ•°æ®
        if db.query(Scenario).count() > 0:
            return

        # åˆ›å»ºé¢„è®¾åœºæ™¯
        scenarios_data = [
            {
                "name": "è¶…å¸‚æ’é˜Ÿ",
                "description": "å­¦ä¹ åœ¨è¶…å¸‚ç»“è´¦æ—¶éµå®ˆæ’é˜Ÿè§„åˆ™",
                "icon": "ğŸ›’",
                "steps": [
                    {
                        "step_order": 1,
                        "instruction": "ç«™åœ¨é»„çº¿åé¢",
                        "image_prompt": "a child standing quietly behind a clear thick yellow line on the floor"
                    },
                    {
                        "step_order": 2,
                        "instruction": "ä¿æŒå®‰å…¨è·ç¦»",
                        "image_prompt": "two children waiting in line with a 2-meter gap between them"
                    }
                ]
            },
            {
                "name": "è¿‡é©¬è·¯",
                "description": "äº¤é€šå®‰å…¨ä¸ä¿¡å·ç¯è¯†åˆ«",
                "icon": "ğŸš¦",
                "steps": [
                    {
                        "step_order": 1,
                        "instruction": "çº¢ç¯åœ",
                        "image_prompt": "a large bright red traffic light symbol"
                    },
                    {
                        "step_order": 2,
                        "instruction": "ç»¿ç¯è¡Œ",
                        "image_prompt": "a large bright green traffic light symbol"
                    }
                ]
            }
        ]

        for scenario_data in scenarios_data:
            steps_data = scenario_data.pop("steps")
            scenario = Scenario(**scenario_data)

            for step_data in steps_data:
                step = TrainingStep(**step_data)
                scenario.steps.append(step)

            db.add(scenario)

        db.commit()
        print("åˆå§‹æ•°æ®åˆ›å»ºå®Œæˆ")

    except Exception as e:
        print(f"åˆ›å»ºåˆå§‹æ•°æ®å¤±è´¥: {e}")
        db.rollback()
    finally:
        db.close()
```

#### 5.2.2 æ¼”ç¤ºè„šæœ¬

**æ–‡ä»¶: `demo-script.md`**
```markdown
# æ˜Ÿæ¡¥ç³»ç»Ÿæ¼”ç¤ºè„šæœ¬

## æ¼”ç¤ºæµç¨‹

### 1. ç³»ç»Ÿä»‹ç» (2åˆ†é’Ÿ)
- é¡¹ç›®èƒŒæ™¯ï¼šä¸“ä¸ºå­¤ç‹¬ç—‡å„¿ç«¥è®¾è®¡çš„AIè®­ç»ƒç³»ç»Ÿ
- æ ¸å¿ƒåŠŸèƒ½ï¼šAIç”Ÿæˆåœºæ™¯ã€è§†è§‰åŒ–è®­ç»ƒã€æ•°æ®ç»Ÿè®¡
- æŠ€æœ¯äº®ç‚¹ï¼šFastAPI + React + Gemini AI

### 2. åŠŸèƒ½æ¼”ç¤º (8åˆ†é’Ÿ)

#### åœºæ™¯1ï¼šä½¿ç”¨é¢„è®¾åœºæ™¯
1. æ‰“å¼€é¦–é¡µï¼Œå±•ç¤ºåœºæ™¯å¡ç‰‡
2. é€‰æ‹©"è¶…å¸‚æ’é˜Ÿ"åœºæ™¯
3. å¼€å§‹è®­ç»ƒï¼Œå±•ç¤ºæ­¥éª¤å¼•å¯¼
4. å®Œæˆè®­ç»ƒï¼ŒæŸ¥çœ‹ç»“æœç»Ÿè®¡

#### åœºæ™¯2ï¼šAIç”Ÿæˆè‡ªå®šä¹‰åœºæ™¯
1. ç‚¹å‡»"æ–°å¢è®­ç»ƒåœºæ™¯"
2. è¾“å…¥"ç†å‘åº—å‰ªå¤´å‘"
3. AIè‡ªåŠ¨ç”Ÿæˆè®­ç»ƒæ­¥éª¤
4. ä½¿ç”¨ç”Ÿæˆçš„å›¾åƒè¿›è¡Œè®­ç»ƒ

#### åœºæ™¯3ï¼šæ•°æ®ç»Ÿè®¡
1. æŸ¥çœ‹è®­ç»ƒå†å²
2. å±•ç¤ºå®Œæˆç‡ç»Ÿè®¡
3. æ¼”ç¤ºæ•°æ®å¯è§†åŒ–

### 3. æŠ€æœ¯æ¶æ„å±•ç¤º (3åˆ†é’Ÿ)
- åç«¯APIæ–‡æ¡£ (http://localhost:8000/docs)
- æ•°æ®åº“ç»“æ„å±•ç¤º
- Dockerå®¹å™¨çŠ¶æ€

### 4. Q&A (2åˆ†é’Ÿ)

## å¤‡ç”¨æ¼”ç¤ºæ–¹æ¡ˆ
- å¦‚æœAIæœåŠ¡ä¸ç¨³å®šï¼Œä½¿ç”¨é¢„ç”Ÿæˆçš„æ¼”ç¤ºæ•°æ®
- ç½‘ç»œé—®é¢˜æ—¶ï¼Œä½¿ç”¨ç¦»çº¿æ¨¡å¼
- å±•ç¤ºä»£ç ç»“æ„å’Œæ¶æ„è®¾è®¡
```

## ğŸ“‹ å®æ–½ checklist

### Phase 1: åŸºç¡€æ­å»º âœ…
- [x] é¡¹ç›®ç»“æ„åˆå§‹åŒ–
- [x] ä¾èµ–å®‰è£…é…ç½®
- [x] æ•°æ®åº“åŸºç¡€é…ç½®
- [x] APIåŸºç¡€æ¡†æ¶

### Phase 2: æ ¸å¿ƒåŠŸèƒ½ âœ…
- [x] æ•°æ®æ¨¡å‹è®¾è®¡
- [x] åç«¯APIå®ç°
- [x] AIæœåŠ¡é›†æˆ
- [x] å‰ç«¯ç»„ä»¶å¼€å‘

### Phase 3: é›†æˆæµ‹è¯• âœ…
- [x] å•å…ƒæµ‹è¯•ç¼–å†™
- [x] é›†æˆæµ‹è¯•å®ç°
- [x] APIæµ‹è¯•è¦†ç›–
- [x] å‰ç«¯ç»„ä»¶æµ‹è¯•

### Phase 4: æ–‡ä»¶å­˜å‚¨ âœ…
- [x] å­˜å‚¨æ¶æ„è®¾è®¡
- [x] æ–‡ä»¶ç®¡ç†æœåŠ¡
- [x] ç¼“å­˜ç­–ç•¥å®ç°
- [x] é™æ€æ–‡ä»¶æœåŠ¡

### Phase 5: éƒ¨ç½²æ¼”ç¤º âœ…
- [x] Dockeré…ç½®å®Œæˆ
- [x] æ¼”ç¤ºæ•°æ®å‡†å¤‡
- [x] æ¼”ç¤ºè„šæœ¬ç¼–å†™
- [x] éƒ¨ç½²ç¯å¢ƒæµ‹è¯•

## ğŸ¯ å…³é”®æˆåŠŸæŒ‡æ ‡

- **åŠŸèƒ½å®Œæ•´æ€§**: æ ¸å¿ƒè®­ç»ƒæµç¨‹å®Œæ•´è¿è¡Œ
- **AIé›†æˆ**: æˆåŠŸç”Ÿæˆåœºæ™¯å’Œå›¾åƒ
- **ç”¨æˆ·ä½“éªŒ**: ç•Œé¢æµç•…ï¼Œæ“ä½œç®€å•
- **æŠ€æœ¯å±•ç¤º**: æ¶æ„æ¸…æ™°ï¼Œä»£ç è§„èŒƒ
- **æ¼”ç¤ºæ•ˆæœ**: èƒ½å¤Ÿæ¸…æ™°å±•ç¤ºé¡¹ç›®ä»·å€¼

---

**å®æ–½è®¡åˆ’å®Œæˆæ—¶é—´**: 24å°æ—¶
**é¢„æœŸæˆæœ**: å¯å®Œæ•´æ¼”ç¤ºçš„AIè®­ç»ƒç³»ç»Ÿ
**æŠ€æœ¯æ ˆ**: FastAPI + React + SQLite + Docker
**æ ¸å¿ƒä»·å€¼**: åˆ›æ–°çš„AIè¾…åŠ©ç‰¹æ®Šæ•™è‚²è§£å†³æ–¹æ¡ˆ
